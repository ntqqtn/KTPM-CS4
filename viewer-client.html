<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Viewer</title>
</head>
<body>
    <h1>Quản lý giá vàng</h1>

    <!-- Hiển thị cập nhật mới nhất -->
    <h2>Lần cập nhật mới nhất:</h2>
    <p id="value">loading...</p>

    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>

    <script>
        const socket = io('http://localhost:8080');
        const valueDisplay = document.getElementById('value');

        async function fetchValue() {
            const data_latest_price = await fetch('http://localhost:8080/get-latest-price');
            const value = await data_latest_price.json();
            console.log("data_latest_price", value);
            valueDisplay.innerText = `
                    Loại vàng: ${value.gold_type}
                    Mua vào: ${value.buy_price}
                    Bán ra: ${value.sell_price}
                    Cập nhật lúc: ${value.updated_at}
                `;
            
        }
       
        fetchValue();
         // Nhận dữ liệu mới từ server qua socket
         socket.on('gold_update', (data) => {
            console.log(data);
            valueDisplay.innerText = `
                Loại vàng: ${data.gold_type}
                Mua vào: ${data.buy_price}
                Bán ra: ${data.sell_price}
                Cập nhật lúc: ${data.updated_at}
            `;
        });
    </script>
</body>
</html>